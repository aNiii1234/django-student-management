{% extends 'base-minimal.html' %}
{% load static %}

{% block title %}é™¢ç³»åˆ—è¡¨ - å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 2rem auto; padding: 0 1rem;">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
        <h1 class="page-title">é™¢ç³»ä¿¡æ¯</h1>
        {% if user.role == 'admin' %}
            <div class="page-actions">
                <a href="{% url 'students:department_create' %}" class="btn btn-primary">
                    æ·»åŠ é™¢ç³»
                </a>
            </div>
        {% endif %}
    </div>

    <!-- é™¢ç³»åˆ—è¡¨ -->
    {% if departments %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
            {% for department in departments %}
                <div class="card">
                    <div style="padding: 1.5rem;">
                        <h3 style="margin: 0 0 1rem 0; color: var(--text-primary);">
                            ğŸ¢ {{ department.name }}
                        </h3>

                        {% if department.description %}
                            <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: 1rem;">
                                {{ department.description|truncatewords:20 }}
                            </p>
                        {% endif %}

                        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                            <span style="color: var(--text-muted); font-size: 0.9rem;">
                                å­¦ç”Ÿæ•°: {{ department.studentprofile_set.count }}
                            </span>
                            <span style="color: var(--text-muted); font-size: 0.9rem;">
                                ä¸“ä¸šæ•°: {{ department.major_set.count }}
                            </span>
                        </div>

                        <!-- æ“ä½œæŒ‰é’® -->
                        {% if user.role == 'admin' %}
                            <div class="table-card-actions">
                                <a href="{% url 'students:department_update' department.id %}" class="btn btn-sm btn-outline">
                                    ç¼–è¾‘
                                </a>
                                <a href="{% url 'students:department_delete' department.id %}" class="btn btn-sm btn-danger">
                                    åˆ é™¤
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <!-- ç©ºçŠ¶æ€ -->
        <div class="empty-state">
            <h3>æ²¡æœ‰é™¢ç³»ä¿¡æ¯</h3>
            <p>ç³»ç»Ÿä¸­è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•é™¢ç³»ã€‚</p>
            {% if user.role == 'admin' %}
                <a href="{% url 'students:department_create' %}" class="btn btn-primary">
                    æ·»åŠ ç¬¬ä¸€ä¸ªé™¢ç³»
                </a>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}