{% extends 'base_minimal.html' %}
{% load static %}
{% block title %}ç®¡ç†å‘˜é¢æ¿ - å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <h1>ç®¡ç†å‘˜é¢æ¿</h1>
</div>

<!-- ç»Ÿè®¡æ•°æ® -->
<div class="row" style="margin-bottom: 2rem;">
    <div class="col-md-4">
        <div class="stats-card">
            <div class="stats-number">{{ total_users }}</div>
            <div class="stats-label">æ€»ç”¨æˆ·æ•°</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="stats-card">
            <div class="stats-number">{{ total_students }}</div>
            <div class="stats-label">å­¦ç”Ÿ</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="stats-card">
            <div class="stats-number">{{ total_teachers }}</div>
            <div class="stats-label">æ•™å¸ˆ</div>
        </div>
    </div>
</div>

<!-- å¾…å¤„ç†æé†’ -->
{% if students_without_profiles_count > 0 %}
<div class="alert alert-warning">
    <strong>å¾…å¤„ç†çš„å­¦ç”Ÿæ¡£æ¡ˆï¼š</strong>
    {{ students_without_profiles_count }} ä½å­¦ç”Ÿéœ€è¦åˆ›å»ºæ¡£æ¡ˆ
    <a href="{% url 'accounts:pending_student_profiles' %}" class="btn btn-warning btn-sm" style="margin-left: 1rem;">ç«‹å³å¤„ç†</a>
</div>
{% endif %}

<!-- å¿«é€Ÿæ“ä½œ -->
<div class="row" style="margin-bottom: 2rem;">
    <div class="col-12">
        <h2>å¿«é€Ÿæ“ä½œ</h2>
    </div>
</div>

<div class="row">
    <div class="col-md-4">
        <a href="{% url 'accounts:user_list' %}" class="clickable-card" style="display: block; background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: inherit; margin-bottom: 1rem;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘¥</div>
            <div style="font-weight: 600; margin-bottom: 0.25rem;">ç”¨æˆ·ç®¡ç†</div>
            <div style="color: #6b7280; font-size: 0.875rem;">ç®¡ç†æ‰€æœ‰ç”¨æˆ·è´¦æˆ·</div>
        </a>
    </div>
    <div class="col-md-4">
        <a href="{% url 'accounts:student_profile_list_admin' %}" class="clickable-card" style="display: block; background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: inherit; margin-bottom: 1rem;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“š</div>
            <div style="font-weight: 600; margin-bottom: 0.25rem;">å­¦ç”Ÿæ¡£æ¡ˆ</div>
            <div style="color: #6b7280; font-size: 0.875rem;">æŸ¥çœ‹å’Œç®¡ç†å­¦ç”Ÿä¿¡æ¯</div>
        </a>
    </div>
    <div class="col-md-4">
        <a href="{% url 'students:department_list' %}" class="clickable-card" style="display: block; background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: inherit; margin-bottom: 1rem;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ«</div>
            <div style="font-weight: 600; margin-bottom: 0.25rem;">é™¢ç³»ä¸“ä¸š</div>
            <div style="color: #6b7280; font-size: 0.875rem;">ç®¡ç†éƒ¨é—¨å’Œä¸“ä¸šè®¾ç½®</div>
        </a>
    </div>
</div>

<!-- æœ€è¿‘æ³¨å†Œç”¨æˆ· -->
{% if recent_users %}
<div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
    <h2 style="margin-bottom: 1rem;">æœ€è¿‘æ³¨å†Œç”¨æˆ·</h2>
    <div class="row">
        {% for user in recent_users %}
        <div class="col-md-4" style="margin-bottom: 1rem;">
            <div style="display: flex; align-items: center; padding: 0.75rem; background: #f9fafb; border-radius: 6px;">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: #2563eb; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 1rem;">
                    {{ user.username.0|upper }}
                </div>
                <div style="flex: 1;">
                    <div style="font-weight: 500;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.875rem; color: #6b7280;">
                        <span class="badge" style="background: #e5e7eb; color: #374151; padding: 0.125rem 0.5rem; border-radius: 12px; font-size: 0.75rem;">{{ user.get_role_display }}</span>
                        <span style="margin-left: 0.5rem;">{{ user.created_at|date:"m-d H:i" }}</span>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}